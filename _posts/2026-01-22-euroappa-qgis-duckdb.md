---
layout: post
title: A Way To Compile A European Plant-Pollinator Atlas Using A GloBI Corpus of Review Datasets, Eurostat/GISCO Geographical data, Open Street Maps, DuckDB, And QGIS
author: Jorrit H. Poelen
date: 2026-01-22
excerpt: "Demonstration on how to build an European Plant-Pollinator Atlas by combining version of the GloBI corpus of Review Datasets with Eurostat/GISCO Geographical country data in a GeoPackage file. This GeoPackage file and associated summaries are then plotted on a world map provided by Open Street Maps using QGIS, an openly available mapping tool."
status: draft
---

Many openly accessible datasets exist that describe how plant interact with their pollinators (e.g., bees, bats, birds). And, an EU Horizon project "Butterfly" [```[1]```](#references) aims to use existing data, complemented by field observations, to establish EuroAPPA, an European Atlas of Plant Pollinator Associations.

There's many ways to build such an atlas and the text below describes one of them. The method below demonstrates how to combine an existing GloBI Corpus of Review Data and Eurostat/GISCO Geographical country data with DuckDB [```[2]```](#references), a small but mighty database, and QGIS, an open source geographic information system tool to create maps to show the geographic distribution of existing flower visitation and pollination record claims.

## Getting the Data

A Dec 2025 compilation of GloBI reviewed datasets is available through:

> Poelen, J. H., & Global Biotic Interactions Community. (2025). Global Biotic Interactions (GloBI) Review Dataset Corpus hash://md5/c326e584fb61f95d0075710c63dc2a33 hash://sha256/bc0292584334bfa2c5babdd59a113428dbdfa2ee9380fd692f1b85bcecb00dac [Data set]. Zenodo. https://doi.org/10.5281/zenodo.18064921 

This compilation dataset includes a derived file that includes reviewed interaction records in a gzipped tab-separated format [```interactions.tsv.gz```](https://zenodo.org/records/18064921/files/interactions.tsv.gz) with digital fingerprint [hash://md5/7c12420410e0fea43608308c387fa89c](https://linker.bio/hash://md5/7c12420410e0fea43608308c387fa89c). 

Also, a geopackage ```CNTR_RG_20M_2024_4326.gpkg``` with digital fingerprint ```hash://md5/8f345c975eb2ba6b1c92ea1ae27ec4cf``` was retrieved from https://ec.europa.eu/eurostat/web/gisco/geodata/administrative-units/countries on 2026-01-21 to help delineate current administrative boundaries of countries of interest.

## Building A GeoPackage Using DuckDB

Using the GloBI data review corpus and downloaded Eurostat/GISCO geographical data, a GeoPackage ```euroappa.gpkg``` was created by selecting only georeferenced flower visitation and pollination claims within EU countries in addition to the United Kingdom, Norway, Switzerland and Ukraine. 

More specifically, the GeoPackage ```euroappa.gpkg``` was generated by running using DuckDB v1.2.1 8e52ec4395 as follows: 


```
cat generate-euroappa.sql | duckdb 
```

with ```generate-euroappa.sql``` containing:

```
INSTALL spatial;
LOAD spatial;
  
CREATE TABLE IF NOT EXISTS interactions 
AS SELECT 
  ST_POINT(decimalLongitude,decimalLatitude) as location, 
  decimalLatitude,
  decimalLongitude,
  sourceTaxonName, 
  interactionTypeName,
  targetTaxonName, 
  "http://rs.tdwg.org/dwc/terms/eventDate" as eventDate,
  referenceCitation, 
  citation, 
  namespace, 
  lastSeenAt
FROM 
  'interactions.tsv.gz'
WHERE 
  interactionTypeName IN ('flowersVisitedBy','visitsFlowersOf', 'pollinates', 'pollinatedBy')
AND
  ST_IsValid(location);


CREATE INDEX IF NOT EXISTS my_idx ON interactions USING RTREE (location);

COPY (
 SELECT interactions.*, countries.ISO3_CODE 
 FROM interactions
  JOIN (select geom as country, ISO3_CODE from 'CNTR_RG_20M_2024_4326.gpkg' WHERE EU_STAT = 'T' OR ISO3_CODE IN ['GBR', 'NOR', 'CHE', 'UKR']) as countries
  ON ST_Within(interactions.location, countries.country)
) 
TO 'euroappa.gpkg'
WITH (FORMAT gdal, DRIVER 'GPKG', SRS 'EPSG:4326');
```

## Data Clustering using DuckDB and H3


The resulting geopackage was clustered using h3 [```[3]```](#references) on resolution level 4 (less granular) and 6 (more granular) to highlight the geographic distribution of flower visitation and pollination claims. These clustered data were packaged in data files ```euroappa-h3-level-4.gpkg``` and ```euroappa-h3-level-6.gpkg``` respectively and generated by:

```
cat generate-euroappa-h3-level-6.sql | duckdb 
```

with ```generate-euroappa-h3-level-6.sql``` containing:

```
INSTALL spatial;
LOAD spatial;
INSTALL h3 FROM community;
LOAD h3;

COPY (
  SELECT ST_GeomFromText(h3_cell_to_boundary_wkt(h3_cell)) as cell_boundary, number_of_records 
  FROM (
    SELECT 
      h3_latlng_to_cell(ST_Y(geom), ST_X(geom), 6) as h3_cell,
      LOG(1+COUNT(*)) as number_of_records
    FROM 
      'euroappa.gpkg'
    GROUP BY 
      h3_cell
) 
)
TO 'euroappa-h3-level-6.gpkg'
WITH (FORMAT gdal, DRIVER 'GPKG', SRS 'EPSG:4326');

```

## Creating Maps Using QGIS

After creating the geopackages, [QGIS](https://en.wikipedia.org/wiki/QGIS) v3.34.4-Prizren was used to visualize the h3 geopackages and put them on a map of the world provided by [OpenStreetMap](https://openstreetmap.org). The three examples shown below highlight geographic areas with higher (darker), lower (lighter), or no data coverage. The yellow/green hexagons are at h3 resolution level 4, whereas the blue hexagons are at h3 resolution level 6. All with © OpenStreetMap contributors and © EuroGeographics for the administrative boundaries .

![euroappa-zoom-in-germany-2026-01-22-smaller.png](/assets/euroappa-zoom-in-germany-2026-01-22-smaller.png)

![euroappa-europe-2026-01-22-smaller.png](/assets/euroappa-europe-2026-01-22-smaller.png)

![euroappa-zoom-in-ireland-uk-2026-01-22-smaller.png](/assets/euroappa-zoom-in-ireland-uk-2026-01-22-smaller.png)
 

## Discussion
Our example shows that geographic maps can be generating using openly available datasets (e.g., GloBI data review corpus, Eurostat/GISCO geographical data) and open source data processing and visualization tools (e.g., DuckDB, QGIS).

## References 

[1] BUTTERFLY: Mainstreaming pollinator stewardship in view of cascading ecological, societal and economic impacts of pollinator decline. 2025. CORDIS / Horizon Europe [doi:10.3030/101181930](https://doi.org/10.3030/101181930) 

[2] Mark Raasveldt and Hannes Mühleisen. 2019. DuckDB: an Embeddable Analytical Database. In Proceedings of the 2019 International Conference on Management of Data (SIGMOD '19). Association for Computing Machinery, New York, NY, USA, 1981–1984. https://doi.org/10.1145/3299869.3320212
  
[3] Brodsky, I., 2019: H3: Uber’s Hexagonal Hierarchical Spatial Index. Available online: https://eng.uber.com/h3/ Accessed January 22, 2026


